default_platform(:android)

  available_build_variants = ['debug', 'release', 'beta']

  def validate_build_variant(build_variant)
    unless available_build_variants.include?(build_variant)
      UI.user_error!("Invalid build variant. Available options are: #{available_build_variants.join(', ')}")
    end
  end

  platform :android do

  desc "Build"
  lane :build do |options|
    build_variant = options[:build_variant] || 'release' # Default to 'release' if no variant is specified
    validate_build_variant(build_variant)
    gradle(task: "clean assembleRelease")
  end

  desc "Runs all the tests"
  lane :test do |options|

    build_variant = options[:build_variant] || 'debug' # Default to 'debug' if no variant is specified
    validate_build_variant(build_variant)

    gradle(task: "test")
  end

  desc "Submit a new Beta Build to Firebase App Distribution"
  lane :deploy_to_firebase do |options|

    build_variant = options[:build_variant] || 'release' # Default to 'release' if no variant is specified
    validate_build_variant(build_variant)

    build

    firebase_app_distribution(
        app: "1:900612138286:android:f84a749cba9daad96bc6bf",
        release_notes: "HAHAHA",
        firebase_cli_token: "1//0g2YwJ-ZSs1BgCgYIARAAGBASNwF-L9Irk-jUQlzHZuP9x1-3ckcjDIwzjxi5hUxrs_Maydo2_jduZB3vQHHQjYJPmcS_kR5bM6w"
    )
  end

#   desc "Deploy a new version to the Google Play"
#   lane :deploy do
#     gradle(task: "clean assembleRelease")
#     upload_to_play_store
#   end
end